version: '3.8'

services:
  apk-builder:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: secureapp-builder
    volumes:
      - .:/project
      - gradle-cache:/root/.gradle
    working_dir: /project
    command: >
      bash -c "
      echo 'ðŸ”¨ Building SecureApp APK...' &&
      ./gradlew clean assembleRelease --stacktrace --no-daemon &&
      echo 'âœ… Build complete!' &&
      echo 'ðŸ“¦ APK location: app/build/outputs/apk/release/app-release-unsigned.apk' &&
      ls -lh app/build/outputs/apk/release/
      "

volumes:
  gradle-cache:
    driver: local
